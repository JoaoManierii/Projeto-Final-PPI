<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Anuncio</title>
    <link rel="shortcut icon" href="../images/logos/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../css/style-anuncio.css">
    <link rel="stylesheet" href="../css/style-anunciar.css">
    <script src="../js/main.js"></script>
    
</head>

<body>
    <header>
        <nav>
            <div class="navbar">
                <ul>
                    <li><a href='../index.html'><img src="../images/logos/logo.png" alt="imagem logo"></a></li>
                    <li class="navbar-menu" id="navbar-menu"><img src="../images/icons/menu.svg" alt=""></li>
                    <div class="navbar-item" id="navbar-item">
                        <li class="navbar-item-li"><a href="../index.html">Pagina Inicial</a></li>
                        <li class="navbar-item-li"><a href="../demonstracao.html">Demonstraçao</a></li>
                        <li class="button-login navbar-item-li"><a href="./login.html">Login</a></li>
                    </div>
                </ul>
            </div>
        </nav>
        <main>
            <div class="login-page">
                <div class="form">
                    <form class="login-form" action="cadastraAnun.php" method="post">
                        <input type="file" name="nomeArqFoto" id="nomeArqFoto">
                        
                        <input type="text" placeholder="Titulo" name="titulo" id="titulo">
                        <input type="text" placeholder="Descriçao" name="descr" id="descr">
                        <input type="number" placeholder="Preço" name="preco" id="preco">
                        <input type="number" placeholder="CEP" name="cep" id="cep">
                        <input type="text" placeholder="Bairro" name="bairro" id="bairro">
                        <input type="text" placeholder="Cidade" name="cidade" id="cidade">
                        <select class="form-select" name="estado" id="estado">
                            <option value="" disabled selected>Estado</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                <select  name="codCategoria" id="codCategoria">
                    <option value="" disabled selected>Categoria</option>
                    <option value="6">Veículo</option>
                    <option value="7">Eletroeletrônico</option>
                    <option value="8">Imóvel</option>
                    <option value="9">Móvel</option>
                    <option value="10">Vestuário</option>
                    <option value="11">Outros</option>
                </select>
                <button name="submit">Cadastrar</button>
                </form>
            </div>
            </div>
        </main>
        <footer class="footer-section">
            <div class="footer">
                <h4>Copyright &copy; 2022, Todos os direitos reservados</h4>
                <ul>
                    <li><a href="#">Home</a></li>
                    <li><a href="#">Termos</a></li>
                    <li><a href="#">Privacidade</a></li>
                    <li><a href="#">Politica</a></li>
                    <li><a href="#">Contato</a></li>
                </ul>
            </div>
        </footer>

        <script>
            
            /*
            const inputFile =  document.querySelector('.imgInput');
            const spanImage = document.querySelector('.imgImage');
    
            inputFile.addEventListener('change', function(e){
                const inputTarget = e.target;
                const file = inputTarget.files[0];
    
                if (file){
                    const reader = new FileReader();
                    reader.addEventListener('load', function(e){
                        const readerTarget = e.target;
                        const img =  document.createElement('img');
                        img.src = readerTarget.result;
                        img.classList.add('imgs');
    
                        spanImage.appendChild(img);
                    });
                    reader.readAsDataURL(file);
                }else{
                    spanImage.innerHTML = spanImageText;
                }
            }); */


    function buscaEndereco(cep) {
      if (cep.length != 9) return;

      let xhr = new XMLHttpRequest();
      xhr.open("GET", "busca-endereco.php?cep=" + cep, true);

      xhr.onload = function () {

        // verifica o código de status retornado pelo servidor
        if (xhr.status != 200) {
          console.error("Falha inesperada: " + xhr.responseText);
          return;
        }

        // converte a string JSON para objeto JavaScript
        try {
          var endereco = JSON.parse(xhr.responseText);
        }
        catch (e) {
          console.error("String JSON inválida: " + xhr.responseText);
          return;
        }

        // utiliza os dados retornados para preencher formulário
        let form = document.querySelector("form");
        form.estado.value = endereco.estado;
        form.bairro.value = endereco.bairro;
        form.cidade.value = endereco.cidade;
      }

      xhr.onerror = function () {
        console.error("Erro de rede - requisição não finalizada");
      };

      xhr.send();
    }

    window.onload = function () {
      const inputCep = document.querySelector("#cep");
      inputCep.onkeyup = () => buscaEndereco(inputCep.value);
    }
    
    
        </script>
</body>

</html>